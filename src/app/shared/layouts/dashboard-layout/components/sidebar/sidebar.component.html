<!-- Side bar -->
<aside class="w-80 hidden md:block">
  <div
    class="sticky top-6 bg-white/50 backdrop-blur-xl rounded-2xl shadow-sm h-[calc(100vh-3rem)] border border-gray-200 overflow-hidden"
  >
    <div class="h-full flex flex-col p-6">
      <!-- Header -->
      <div class="mb-8">
        <h2 class="text-xl font-semibold text-gray-900">TravelApp</h2>
      </div>

      <!-- Navigation -->
      <nav class="flex-1 overflow-y-auto -mx-3">
        <!-- Dashboard/Overview -->
        <a
          routerLink="/overview"
          routerLinkActive="active-link"
          [routerLinkActiveOptions]="{ exact: true }"
          class="relative flex items-center gap-3 px-3 py-2 mx-3 rounded-lg text-gray-800 text-sm mb-2 transition-all hover:bg-white hover:shadow-sm overflow-clip"
          [class.bg-white]="isActiveRoute('/overview')"
          [class.shadow-sm]="isActiveRoute('/overview')"
          [class.text-black]="isActiveRoute('/overview')"
        >
          <!-- Indicador vertical -->
          <div
            class="absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-6 rounded-r-full transition-all"
            [class.bg-gray-900]="isActiveRoute('/overview')"
          ></div>
          <span class="text-black">Dashboard</span>
        </a>

        <!-- Divider -->
        <div class="h-px bg-gray-200 my-4 mx-3"></div>

        <!-- Trips Section Header con botón -->
        <div class="flex items-center justify-between px-3 py-2 mb-2 mx-3">
          <h3 class="text-xs font-semibold uppercase tracking-wider text-gray-400">Mis Viajes</h3>
          @if (!isLoading() && trips().length > 0) {
          <button
            type="button"
            (click)="openModal()"
            class="w-6 h-6 flex p-3 text-white bg-black hover:bg-black/90 shadow-sm rounded-full items-center justify-center transition-colors cursor-pointer"
            title="Crear nuevo viaje"
          >
            <i class="pi pi-plus" style="color: white; font-size: 0.7rem"></i>
          </button>
          }
        </div>

        <!-- Loading trips -->
        @if (isLoading()) {
        <div class="px-3 py-2 text-center mx-3">
          <span class="text-xs text-gray-400">Cargando viajes...</span>
        </div>
        }

        <!-- Trips list -->
        @if (!isLoading() && trips().length > 0) {
        <div class="flex flex-col gap-2">
          @for (trip of trips(); track trip.id) {
          <a
            [routerLink]="['/trips', trip.id]"
            routerLinkActive="active-trip"
            class="relative flex flex-col gap-1 px-3 py-2 mx-3 rounded-lg transition-all cursor-pointer hover:bg-white hover:shadow-sm group"
            [class.bg-white]="isTripActive(trip.id)"
            [class.shadow-sm]="isTripActive(trip.id)"
          >
            <div
              class="absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-8 rounded-r-full transition-all"
              [class.bg-gray-900]="isTripActive(trip.id)"
              [class.bg-transparent]="!isTripActive(trip.id)"
            ></div>
            <span class="text-base font-medium text-gray-900 truncate">
              {{ trip.name }}
            </span>
            <span class="text-xs text-gray-500 truncate">
              {{ trip.city }}, {{ trip.country }}
            </span>
          </a>
          }
        </div>
        }

        <!-- Empty state -->
        @if (!isLoading() && trips().length === 0) {
        <div class="px-3 py-4 text-center mx-3">
          <p class="text-xs text-gray-400 mb-2">No tienes viajes aún</p>
          <button
            (click)="openModal()"
            class="inline-block px-4 py-2 bg-gray-900 text-white text-xs rounded-lg hover:bg-gray-800 transition-colors"
          >
            Crear viaje
          </button>
        </div>
        }
      </nav>

      <!-- Footer -->
      <div class="border-t border-gray-200 pt-4 shrink-0">
        <!-- Settings -->
        <a
          routerLink="/settings"
          routerLinkActive="active-link"
          class="relative flex items-center gap-3 px-3 py-2 rounded-lg text-gray-800 text-sm mb-2 transition-all hover:bg-white hover:shadow-sm"
          [class.bg-white]="isActiveRoute('/settings')"
          [class.text-black]="isActiveRoute('/settings')"
          [class.shadow-sm]="isActiveRoute('/settings')"
        >
          <div
            class="absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-6 rounded-r-full transition-all"
            [class.bg-gray-900]="isActiveRoute('/settings')"
            [class.bg-transparent]="!isActiveRoute('/settings')"
          ></div>
          <span>Configuración</span>
        </a>

        <!-- Logout -->
        <button
          (click)="onLogout()"
          class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 hover:text-red-500 text-sm w-full text-left hover:bg-white hover:shadow-sm transition-all cursor-pointer"
        >
          <span>Cerrar sesión</span>
        </button>

        <!-- User info -->
        @if (user) {
        <div class="mt-4 pt-4 border-t border-gray-200">
          <div class="flex items-center gap-3">
            <div
              class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-sm font-medium text-gray-600 shrink-0"
            >
              {{ getInitial(user) }}
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 truncate">
                {{ getDisplayName(user) || 'Usuario' }}
              </p>
              <p class="text-xs text-gray-500 truncate">
                {{ user.email }}
              </p>
            </div>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
</aside>
