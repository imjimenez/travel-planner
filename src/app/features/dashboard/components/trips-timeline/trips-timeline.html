<!-- Hero Card - Next Trip -->
<div
  class="mb-12 relative overflow-hidden rounded-2xl bg-linear-to-r from-emerald-700 to-teal-600"
>
  <div class="relative p-8 md:p-12">
    <div class="flex flex-col md:flex-row justify-between gap-6 mb-6">
      <div class="flex-1">
        <p-tag
          value="Próximo viaje"
          severity="info"
          class="mb-3 bg-white/20 border-white/30 text-white w-full md:max-w-60"
        />
        <h2 class="text-2xl text-center sm:text-left md:text-4xl lg:text-5xl font-bold text-white mb-3">{{ nextTrip().name }}</h2>
        <div class="flex items-center gap-2 text-white/90 md:text-lg">
          <i class="pi pi-calendar"></i>
          <span>
            {{ nextTrip().start_date | date:'dd/MM/yyyy' }} - {{ nextTrip().end_date |
            date:'dd/MM/yyyy' }}
          </span>
        </div>
      </div>

      <div
        class="bg-white/10 backdrop-blur-md rounded-2xl p-8 text-center border border-white/20 shadow-xl"
      >
        <div class="text-6xl font-bold text-white mb-2">{{ nextTrip().leftDays }}</div>
        <div class="text-white/90 text-base font-medium">días restantes</div>
      </div>
    </div>

    <div class="grid grid-cols-1 gap-6 mb-8">
      <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20">
        <div class="flex items-center gap-3 text-white">
          <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
            <i class="pi pi-clock text-xl"></i>
          </div>
          <div>
            <div class="text-white/70 text-sm font-medium">Duración</div>
            <div class="text-xl font-bold">{{ nextTrip().durationDays }} días</div>
          </div>
        </div>
      </div>
    </div>

      <p-button
        label="Ver detalles del viaje"
        icon="pi pi-arrow-right"
        iconPos="right"
        [routerLink]="['../trips', nextTrip().id]"
        styleClass="p-button-lg bg-white hover:bg-gray-50 text-emerald-700 border-none shadow-lg w-full md:w-auto"
      />
  </div>
</div>

<!-- Timeline Section -->
<div class="mb-2 md:mb-8 flex flex-col">
  <h3 class="text-2xl font-bold text-gray-800 mb-6">Timeline de Viajes</h3>

  <!-- Upcoming Trips Timeline -->
  @if(upcomingTrips().length > 0) {
  <div class="mb-2 md:mb-4 lg:mb-8">
    <div class="flex items-center gap-2 mb-6">
      <div class="h-px flex-1 bg-linear-to-r from-transparent to-emerald-200"></div>
      <span class="text-sm font-semibold text-emerald-700 px-3">PRÓXIMOS VIAJES</span>
      <div class="h-px flex-1 bg-linear-to-l from-transparent to-emerald-200"></div>
    </div>

    <p-timeline [value]="upcomingTrips()" layout="vertical" class="custom-timeline">

      <ng-template #marker let-trip>
        <div
          class="w-5 h-5 rounded-full shadow-lg"
          [ngClass]="{
                    'bg-amber-500': trip.leftDays <= 30 && trip.leftDays > 0,
                    'bg-emerald-500': trip.leftDays > 30
                  }"
        ></div>
      </ng-template>

      <ng-template #content let-trip>
        <p-card
          styleClass="shadow-md hover:shadow-xl transition-all cursor-pointer mb-4 border-none hover-card"
          [routerLink]="['../trips', trip.id]"
        >
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1">
              <h4 class="text-xl font-bold text-gray-800 mb-2">{{ trip.name }}</h4>
              
            </div>
          </div>
        </p-card>
      </ng-template>

      <ng-template #opposite let-trip>
        <div class="flex flex-col items-end ">
          <div class="flex items-center gap-2 text-gray-600 mb-3">
          <i class="pi pi-calendar text-sm"></i>
          <span class="text-sm">
            {{ trip.start_date | date: 'dd/MM/yyyy' }} - {{ trip.end_date | date: 'dd/MM/yyyy'
            }}
          </span>
        </div>
        <div class="flex flex-col items-center md:flex-row gap-1 md:gap-4 text-sm mb-4">
          <span class="text-gray-500">
            <i class="pi pi-clock mr-1"></i>
            {{ trip.durationDays }} días
          </span>
          <p-tag
            [value]="'En ' + trip.leftDays + ' días'"
            [severity]="trip.leftDays > 30 ? 'success' : 'warn'"
          />
        </div>
        </div>
      </ng-template>
    </p-timeline>
  </div>
  }

  <!-- Past Trips Timeline -->
  @if(pastTrips().length > 0) {
  <div>
    <div class="flex items-center gap-2 mb-6">
      <div class="h-px flex-1 bg-linear-to-r from-transparent to-gray-300"></div>
      <span class="text-sm font-semibold text-gray-500 px-3">VIAJES REALIZADOS</span>
      <div class="h-px flex-1 bg-linear-to-l from-transparent to-gray-300"></div>
    </div>

    <p-timeline [value]="pastTrips()" layout="vertical" use="custom-timeline">
      <ng-template #marker let-trip>
        <div class="w-5 h-5 rounded-full bg-gray-400 shadow"></div>
      </ng-template>

      <ng-template #content let-trip>
        <p-card
          styleClass="shadow-sm hover:shadow-md transition-all cursor-pointer mb-4 opacity-75 hover:opacity-100 border-none hover-card"
          [routerLink]="['../trips', trip.id]"
        >
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1">
              <h4 class="text-xl font-bold text-gray-700 mb-2">{{ trip.name }}</h4>
              <div class="flex items-center gap-2 text-gray-500 mb-2">
                <i class="pi pi-calendar text-sm"></i>
                <span class="text-sm">
                  {{ trip.start_date | date:'dd/MM/yyyy' }} - {{ trip.end_date | date:'dd/MM/yyyy'
                  }}
                </span>
              </div>
              <p-tag value="Viaje completado" severity="secondary" styleClass="text-xs" />
            </div>
          </div>
        </p-card>
      </ng-template>
    </p-timeline>
  </div>
  }
</div>

<!-- Add New Trip Button -->
<div class="flex justify-center mb-4 md:mb-8">
  <p-button
    label="Planear nuevo viaje"
    icon="pi pi-plus"
    routerLink="../trips/new"
    styleClass="p-button-lg shadow-lg "
  />
</div>
